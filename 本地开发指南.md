# æœ¬åœ°å¼€å‘æŒ‡å—

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹æ³•ä¸€ï¼šä¸€é”®å¯åŠ¨ï¼ˆæ¨èï¼‰

åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œï¼š

```bash
start-dev.bat
```

è¿™ä¼šè‡ªåŠ¨å¯åŠ¨ï¼š
- åç«¯æœåŠ¡å™¨ï¼ˆhttp://localhost:8787ï¼‰
- å‰ç«¯æœåŠ¡å™¨ï¼ˆhttp://localhost:5173ï¼‰

ä¸¤ä¸ªæœåŠ¡å™¨ä¼šåœ¨ç‹¬ç«‹çš„çª—å£ä¸­è¿è¡Œã€‚

### æ–¹æ³•äºŒï¼šåˆ†åˆ«å¯åŠ¨

#### 1. å¯åŠ¨åç«¯

```bash
cd workers
npm run dev
```

æˆ–ä½¿ç”¨å¿«æ·è„šæœ¬ï¼š

```bash
cd workers
dev.bat
```

#### 2. å¯åŠ¨å‰ç«¯

åœ¨å¦ä¸€ä¸ªç»ˆç«¯ï¼š

```bash
cd frontend
npm run dev
```

æˆ–ä½¿ç”¨å¿«æ·è„šæœ¬ï¼š

```bash
cd frontend
dev.bat
```

## ğŸ“ ç¯å¢ƒé…ç½®è¯´æ˜

### å‰ç«¯ç¯å¢ƒå˜é‡

å‰ç«¯ä½¿ç”¨ Vite çš„ç¯å¢ƒå˜é‡ç³»ç»Ÿï¼š

- **`.env.development`** - æœ¬åœ°å¼€å‘ç¯å¢ƒï¼ˆè‡ªåŠ¨ä½¿ç”¨ï¼‰
  ```
  VITE_API_BASE=http://localhost:8787/api
  VITE_WS_URL=ws://localhost:8787/ws
  ```

- **`.env.production`** - ç”Ÿäº§ç¯å¢ƒï¼ˆæ„å»ºæ—¶ä½¿ç”¨ï¼‰
  ```
  VITE_API_BASE=https://tempemail-back.pslucieljw.workers.dev/api
  VITE_WS_URL=wss://tempemail-back.pslucieljw.workers.dev/ws
  ```

- **`.env`** - âš ï¸ ä¸è¦æ‰‹åŠ¨åˆ›å»ºæ­¤æ–‡ä»¶ï¼
  - è¿™ä¸ªæ–‡ä»¶ç”± `deploy-prod.bat` éƒ¨ç½²è„šæœ¬è‡ªåŠ¨åˆ›å»º
  - å¦‚æœå­˜åœ¨ï¼Œä¼šè¦†ç›–å¼€å‘ç¯å¢ƒé…ç½®
  - å·²æ·»åŠ åˆ° `.gitignore`ï¼Œä¸ä¼šæäº¤åˆ° Git

### åç«¯ç¯å¢ƒå˜é‡

åç«¯é…ç½®åœ¨ `workers/wrangler.toml`ï¼š

```toml
[vars]
DOMAIN_NAME = "dengzi52.dpdns.org"
ACCESS_PASSWORD = "admin123"
TEMPMAILAPI_KEY = "CZXXyF8jg5JRH7UbQWVYiKMQjQznCB6"

[dev]
port = 8787
```

## ğŸ”§ å¸¸è§é—®é¢˜

### é—®é¢˜ 1: å‰ç«¯æ— æ³•è¿æ¥åˆ°åç«¯

**ç—‡çŠ¶ï¼š** å‰ç«¯æ˜¾ç¤º"æ— æ³•è¿æ¥åˆ°æœåŠ¡å™¨"

**åŸå› ï¼š**
1. åç«¯æœªå¯åŠ¨
2. `frontend/.env` æ–‡ä»¶å­˜åœ¨ä¸”æŒ‡å‘ç”Ÿäº§ç¯å¢ƒ

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# 1. åˆ é™¤ frontend/.env æ–‡ä»¶ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
del frontend\.env

# 2. ç¡®ä¿åç«¯æ­£åœ¨è¿è¡Œ
cd workers
npm run dev

# 3. é‡å¯å‰ç«¯
cd frontend
npm run dev
```

### é—®é¢˜ 2: ç«¯å£è¢«å ç”¨

**ç—‡çŠ¶ï¼š** å¯åŠ¨æ—¶æç¤ºç«¯å£ 8787 æˆ– 5173 å·²è¢«å ç”¨

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# Windows - æŸ¥æ‰¾å¹¶ç»“æŸå ç”¨ç«¯å£çš„è¿›ç¨‹
netstat -ano | findstr :8787
taskkill /PID <è¿›ç¨‹ID> /F

netstat -ano | findstr :5173
taskkill /PID <è¿›ç¨‹ID> /F
```

### é—®é¢˜ 3: æ•°æ®åº“æœªåˆå§‹åŒ–

**ç—‡çŠ¶ï¼š** åç«¯å¯åŠ¨åè®¿é—® API æŠ¥é”™

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
cd workers
npm run db:init
```

## ğŸ“¦ éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ

### éƒ¨ç½²åç«¯

```bash
cd workers
npx wrangler deploy
```

### éƒ¨ç½²å‰ç«¯

```bash
cd frontend
deploy-prod.bat
```

æˆ–æ‰‹åŠ¨ï¼š

```bash
cd frontend
npm run build
npx wrangler pages deploy dist --project-name=tempemail --commit-dirty=true
```

## ğŸ”„ ç¯å¢ƒåˆ‡æ¢

### æœ¬åœ°å¼€å‘ â†’ ç”Ÿäº§ç¯å¢ƒ

1. åœæ­¢æœ¬åœ°æœåŠ¡å™¨ï¼ˆCtrl+Cï¼‰
2. è¿è¡Œéƒ¨ç½²è„šæœ¬ï¼š
   ```bash
   cd workers
   npx wrangler deploy
   
   cd frontend
   deploy-prod.bat
   ```

### ç”Ÿäº§ç¯å¢ƒ â†’ æœ¬åœ°å¼€å‘

1. åˆ é™¤ `frontend/.env`ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
2. å¯åŠ¨æœ¬åœ°æœåŠ¡å™¨ï¼š
   ```bash
   start-dev.bat
   ```

## ğŸ“Š å¼€å‘å·¥å…·

### æŸ¥çœ‹æœ¬åœ°æ•°æ®åº“

```bash
cd workers
npx wrangler d1 execute tempemail --local --command "SELECT * FROM emails"
```

### æŸ¥çœ‹ç”Ÿäº§æ•°æ®åº“

```bash
cd workers
npx wrangler d1 execute tempemail --remote --command "SELECT * FROM emails"
```

### æŸ¥çœ‹æ—¥å¿—

- **æœ¬åœ°å¼€å‘ï¼š** æ—¥å¿—ç›´æ¥æ˜¾ç¤ºåœ¨ç»ˆç«¯
- **ç”Ÿäº§ç¯å¢ƒï¼š** ä½¿ç”¨ Cloudflare Dashboard æˆ– `wrangler tail`

```bash
cd workers
npx wrangler tail
```

## ğŸ¯ æœ€ä½³å®è·µ

1. **æ°¸è¿œä¸è¦æ‰‹åŠ¨åˆ›å»º `frontend/.env` æ–‡ä»¶**
   - æœ¬åœ°å¼€å‘ä½¿ç”¨ `.env.development`
   - ç”Ÿäº§æ„å»ºä½¿ç”¨ `.env.production`
   - `.env` ä»…ç”±éƒ¨ç½²è„šæœ¬ä¸´æ—¶åˆ›å»º

2. **ä½¿ç”¨ç‹¬ç«‹çš„ç»ˆç«¯çª—å£**
   - åç«¯ä¸€ä¸ªçª—å£
   - å‰ç«¯ä¸€ä¸ªçª—å£
   - ä¾¿äºæŸ¥çœ‹å„è‡ªçš„æ—¥å¿—

3. **å®šæœŸæ¸…ç†æœ¬åœ°æ•°æ®åº“**
   ```bash
   cd workers
   reset-local-db.bat
   ```

4. **æµ‹è¯•å‰å…ˆæ£€æŸ¥ç¯å¢ƒ**
   - ç¡®è®¤åç«¯åœ¨ http://localhost:8787 å“åº”
   - ç¡®è®¤å‰ç«¯åœ¨ http://localhost:5173 å¯è®¿é—®
   - æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [Vite ç¯å¢ƒå˜é‡æ–‡æ¡£](https://vitejs.dev/guide/env-and-mode.html)
- [Cloudflare Workers æ–‡æ¡£](https://developers.cloudflare.com/workers/)
- [Wrangler CLI æ–‡æ¡£](https://developers.cloudflare.com/workers/wrangler/)

